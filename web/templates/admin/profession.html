{% extends 'common/layout_mainn.html' %}{% block css %}    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">    <link href="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.11/summernote.css" rel="stylesheet">{#    <link rel="stylesheet" type="text/css" href="http://apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.css" />#}{#    <link href="{{ buildStaticUrl( 'js/dist/summernote.css') }}" rel="stylesheet"/>#}{% endblock %}{% block pcoded %}    <nav class="pcoded-navbar">        <div class="navbar-wrapper">            <div class="navbar-brand header-logo">                <a href="index.html" class="b-brand">                    <span class="b-title">后台管理系统</span>                </a>                <a class="mobile-menu" id="mobile-collapse" href="javascript:"><span></span></a>            </div>            <div class="navbar-content scroll-div">                <ul class="nav pcoded-inner-navbar">                    <li class="nav-item pcoded-menu-caption">                        <label>管理员</label>                    </li>                    <li data-username="dashboard Default Ecommerce CRM Analytics Crypto Project"                        class="nav-item pcoded-hasmenu active pcoded-trigger">                        <a href="javascript:" class="nav-link"><span class="pcoded-micon"><i                                class="feather icon-home"></i></span><span class="pcoded-mtext">管理员操作</span></a>                        <ul class="pcoded-submenu">                            <li class=""><a href="{{ buildUrl('/admin/index') }}" class="">数据管理</a></li>                            <li class="active"><a href="{{ buildUrl('/admin/profession') }}" class="">修改与增加</a></li>                            <li class=""><a href="{{ buildUrl('/admin/controlmsg') }}" class="">留言管理</a></li>                            <li class=""><a href="{{ buildUrl('/admin/manager?id=1') }}" class="">管理员信息</a></li>                        </ul>                    </li>                </ul>            </div>        </div>    </nav>{% endblock %}{% block content %}{#    <link rel="stylesheet" type="text/css" href="http://apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.css" />#}{#    <link href="{{ buildStaticUrl( 'js/dist/summernote.css') }}" rel="stylesheet"/>#}    <script src="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.11/summernote.js"></script>    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js"></script>{#    <script src="{{ buildStaticUrl( 'js/dist/lang/summernote-zh-CN.js') }}"></script>#}    <div class="pcoded-main-container">        <div class="pcoded-wrapper">            <div class="pcoded-content">                <div class="pcoded-inner-content">                    <!-- [ breadcrumb ] start -->                    <div class="page-header">                        <div class="page-block">                            <div class="row align-items-center">                                <div class="col-md-12">                                    <div class="page-header-title">                                        <h5 class="m-b-10">管理员</h5>                                    </div>                                    <ul class="breadcrumb">                                        <li class="breadcrumb-item"><a href="javascript:"><i                                                class="feather icon-home"></i></a></li>                                        <li class="breadcrumb-item"><a href="javascript:">修改与增加</a></li>                                    </ul>                                </div>                            </div>                        </div>                    </div>                    <div class="main-body">                        <div class="page-wrapper">                            <div class="col-xl-12">                                <div class="card">                                    <div class="card-header">                                        <h5>修改与增加</h5>                                    </div>                                    <div class="col-md-6">                                        <div>                                            <div class="form-group">                                                <form name="form" method="post" enctype="multipart/form-data" action="/admin/update">                                                    <input type="hidden" class="form-control" name="id" value="{{ info.id }}">                                                    <label for="exampleInputEmail1">大标题</label>                                                    <input type="text" class="form-control" name="f0" value="{{ info.f0 }}">                                                    <label for="exampleInputPassword1">中标题</label>                                                    <input type="text" class="form-control" name="f1" value="{{ info.f1 }}" placeholder="若没有下级标签则填 ' / ' ">                                                    <label for="exampleInputPassword1">小标题</label>                                                    <input type="text" class="form-control" name="f2" value="{{ info.f2 }}" placeholder="若没有下级标签则填 ' / ' ">                                                    <label for="exampleInputPassword1">标题</label>                                                    <input type="text" class="form-control" name="title" value="{{ info.title }}">                                                    <label for="exampleInputPassword1">简介</label>                                                    <input type="text" class="form-control" name="Introduction" value="{{ info.Introduction }}">                                                    <label for="exampleInputPassword1">标题图片</label>                                                    <br>                                                    <img src="{{ buildImageUrl(info.image) }}" id="img" style="width:300px;height:180px">                                                    <input type="file" name="image" value="{{ info.image }}" onchange="preview(this) ">                                                     <label for="exampleInputPassword1">跳转地址</label>                                                    <input type="text" class="form-control" name="url" value="{{ info.url }}">                                                    <label for="exampleInputPassword1">时间</label>                                                    <input type="text" class="form-control" name="time" value="{{ info.time }}" placeholder="时间标准格式：2018-09-09 11:12:13">                                                    <label for="exampleInputPassword1">内容中的链接地址</label>                                                    <input type="text" class="form-control" name="content_url" value="{{ info.content_url }}">                                                    <label for="exampleInputPassword1">内容</label>                                                    <textarea id="summernote" name="content">{{ info.content }}</textarea>                                                    <button type="submit" class="btn btn-primary">提交</button>                                                </form>                                            </div>                                        </div>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>            </div>        </div>    </div>{% endblock %}{% block js %}    <script src="{{ buildStaticUrl( 'js/js/jquery.min.js') }}"></script>    <script src="{{ buildStaticUrl( 'js/js/bootstrap.min.js') }}"></script>    <script src="{{ buildStaticUrl( 'js/dist/summernote.js') }}"></script>    <script src="{{ buildStaticUrl( 'js/dist/lang/summernote-zh-CN.js') }}"></script>    <script>        function add() {            let f0 = $("input[id=f0]").val();            let f1 = $("input[id=f1]").val();            let f2 = $("input[id=f2]").val();            let title = $("input[id=title]").val();            let time = $("input[id=time]").val();            let content = $("input[id=content]").val();            let content_url = $("input[id=content_url]").val();            let url = $("input[id=url]").val();            let Introduction = $("input[id=Introduction]").val();            let image = $("input[id=image]").val();            let content_title = $("input[id=content_title]").val();            $.ajax({                url: common_ops.buildUrl("/admin/add"),                type: 'POST',                data: {'f0': f0, 'f1': f1, 'f2': f2, 'title': title, 'time': time, 'content': content, 'content_url': content_url, 'url': url, 'Introduction':Introduction, 'image': image},                dataType: 'json',                success: function (res) {                    alert(res.msg);                }            });        }        function preview(file) {            var title_image = document.getElementById('img');            if (file.files && file.files[0]) {                var reader = new FileReader();                reader.onload = function (evt) {                    title_image.src = evt.target.result                }                reader.readAsDataURL(file.files[0]);            } else {                prevDiv.innerHTML = '<div class="img" style="width:300px;height:180px;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src=\'' + file.value + '\'"></div>';            }        }        let summer = $('#summernote');        summer.summernote({            tabsize: 2,            width: 1000,            height: 400,            callbacks: {                onImageUpload: function (files) {                    sendFile(files);                }            }        });        /** * 发送图片文件给服务器端 */        function sendFile(files) {            console.log('aaa',files)            var formData = new FormData()            formData.append('file', files[0])            $.ajax({                url: '/admin/upload_img/', // 图片上传url                type: 'POST',                data: formData,                cache: false,                contentType: false,                processData: false,                dataType: 'json',     // 以json的形式接收返回的数据                // 图片上传成功                success: function ($result) {                    let imgNode = document.createElement("img");                    imgNode.src = $result.img;                    summer.summernote('insertNode', imgNode);                },                // 图片上传失败                error: function () {                    console.log('图片上传失败');                }            });        }    </script>{% endblock %}